<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link href="https://gistcdn.githack.com/samuelcolvin/647671890d647695930ff74f1ca5bfc2/raw/9f925f043fee5f32345f76d45dd1c6dbde4d4315/notbook.css" rel="stylesheet">
    <title>Notbook</title>
    <meta name="description" content="An experiment in displaying python scripts.">
  </head>
  <body>
    <nav>
      <div class="page-width">
        <div class="d-flex justify-content-between align-items-baseline">
          <div>
            <h1>Notbook</h1>
          </div>
          <div>
            <a class="repo-link" href="https://github.com/samuelcolvin/notbook" target="_blank" title="view on github">
              <img class="mr-1" src="https://gistcdn.githack.com/samuelcolvin/647671890d647695930ff74f1ca5bfc2/raw/9f925f043fee5f32345f76d45dd1c6dbde4d4315/github.png"/>
              samuelcolvin/notbook
            </a>
          </div>
        </div>
        <small>An experiment in displaying python scripts.</small>
      </div>
    </nav>
    <article>


      <main>
        
    <section class="text-section">
      <div>
        <p><em>This is an example of a better way to work on and display numerical python code.</em></p>
<h1 id="1-logistic-curve-fitting-example">Logistic curve fitting example</h1>

<p>(Example is taken mostly from 
<a href="https://ipython-books.github.io/93-fitting-a-function-to-data-with-nonlinear-least-squares/" target="_blank">here</a>)</p>

<p>We define a logistic function with four parameters:</p>
<p class="equation d-none">  \[f_{a,b,c,d}(x) = \frac{a}{1 + \exp\left(-c (x-d)\right)} + b\]
</p>
        </div>
      
    </section>
    <section class="code-section">
      <div>
        <pre class="code-block"><span class="highlight"><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">c</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">d</span><span class="p">)))</span> <span class="o">+</span> <span class="n">b</span></span></pre></div>
      
        <div class="text-muted text-center mt-1 small">The equation we&#39;ll try and fit</div>
      
    </section>
    <section class="text-section">
      <div>
        <p>Define some random parameters:</p>

        </div>
      
    </section>
    <section class="code-section">
      <div>
        <pre class="code-block"><span class="highlight"><span class="n">a</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">b</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span></span></pre></div>
      
    </section>
    <section class="text-section">
      <div>
        <p>which are:</p>

        </div>
      
    </section>
    <section class="print-section">
      <div>
        <pre class="print-statement">a=0.8744 b=-2.0836 c=1.3389 d=0.4991 </pre>
        </div>
      
    </section>
    <section class="text-section">
      <div>
        <p>Now, we generate random data points by using the sigmoid function and adding a bit of noise:</p>

        </div>
      
    </section>
    <section class="code-section">
      <div>
        <pre class="code-block"><span class="highlight"><span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">y_model</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y_model</span> <span class="o">+</span> <span class="n">a</span> <span class="o">*</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n</span><span class="p">)</span></span></pre></div>
      
    </section>
    <section class="text-section">
      <div>
        <p>Plot that to see how it looks:</p>

        </div>
      
    </section>
    <section class="plot-section">
      <div>
        
            <div class="bk-root" id="6b178832-9bd3-4d57-87b5-f0833b3f4984" data-root-id="1001"></div>
<script type="application/json" id="1171">
  {"26c41516-766b-4dff-bf7c-9a2d4e56766a":{"roots":{"references":[{"attributes":{"source":{"id":"1034"}},"id":"1038","type":"CDSView"},{"attributes":{},"id":"1040","type":"BasicTickFormatter"},{"attributes":{},"id":"1058","type":"Selection"},{"attributes":{},"id":"1059","type":"UnionRenderers"},{"attributes":{},"id":"1004","type":"DataRange1d"},{"attributes":{},"id":"1042","type":"BasicTickFormatter"},{"attributes":{"bottom_units":"screen","fill_alpha":0.5,"fill_color":"lightgrey","left_units":"screen","level":"overlay","line_alpha":1.0,"line_color":"black","line_dash":[4,4],"line_width":2,"render_mode":"css","right_units":"screen","top_units":"screen"},"id":"1026","type":"BoxAnnotation"},{"attributes":{},"id":"1010","type":"LinearScale"},{"attributes":{},"id":"1013","type":"BasicTicker"},{"attributes":{"axis_label_text_font":"Ubuntu Mono, monospace","axis_label_text_font_size":"1.2rem","formatter":{"id":"1040"},"major_label_text_font_size":"1rem","ticker":{"id":"1013"}},"id":"1012","type":"LinearAxis"},{"attributes":{},"id":"1008","type":"LinearScale"},{"attributes":{"axis":{"id":"1012"},"ticker":null},"id":"1015","type":"Grid"},{"attributes":{"axis_label_text_font":"Ubuntu Mono, monospace","axis_label_text_font_size":"1.2rem","formatter":{"id":"1042"},"major_label_text_font_size":"1rem","ticker":{"id":"1017"}},"id":"1016","type":"LinearAxis"},{"attributes":{},"id":"1017","type":"BasicTicker"},{"attributes":{"aspect_ratio":1.78,"below":[{"id":"1012"}],"center":[{"id":"1015"},{"id":"1019"},{"id":"1045"}],"left":[{"id":"1016"}],"renderers":[{"id":"1037"},{"id":"1050"}],"sizing_mode":"stretch_both","title":{"id":"1002"},"toolbar":{"id":"1027"},"x_range":{"id":"1004"},"x_scale":{"id":"1008"},"y_range":{"id":"1006"},"y_scale":{"id":"1010"}},"id":"1001","subtype":"Figure","type":"Plot"},{"attributes":{"axis":{"id":"1016"},"dimension":1,"ticker":null},"id":"1019","type":"Grid"},{"attributes":{"overlay":{"id":"1026"}},"id":"1022","type":"BoxZoomTool"},{"attributes":{"click_policy":"hide","items":[{"id":"1046"},{"id":"1060"}],"label_text_font":"Merriweather, serif","label_text_font_size":"1rem","location":"top_left"},"id":"1045","type":"Legend"},{"attributes":{"data":{"x":{"__ndarray__":"AAAAAAAAJMBDYt7OkJgjwIbEvJ0hMSPAyiabbLLJIsANiXk7Q2IiwFDrVwrU+iHAk0022WSTIcDXrxSo9SshwBoS83aGxCDAXXTRRRddIMBArV8pUOsfwMdxHMdxHB/ATjbZZJNNHsDU+pUCtX4dwFq/UqDWrxzA4YMPPvjgG8BoSMzbGRIbwO4MiXk7QxrAdNFFF110GcD7lQK1fqUYwIFav1Kg1hfACB988MEHF8CO4ziO4zgWwBWo9SsFahXAm2yyySabFMAiMW9nSMwTwKj1KwVq/RLAL7rooosuEsC1fqVArV8RwDxDYt7OkBDAhA8++OCDD8CSmLczJOYNwJ4hMW9nSAzAqqqqqqqqCsC4MyTm7QwJwMS8nSExbwfA0kUXXXTRBcDezpCYtzMEwOxXCtT6lQLA+OCDDz74AMAI1PqVArX+vyjm7QyJefu/QPjggw8++L9YCtT6lQL1v3Acx3Ecx/G/IF100UUX7b9QgVq/UqDmv4ClQK1fKeC/YJNNNtlk078Ab2dIzNu5vwBvZ0jM27k/YJNNNtlk0z+ApUCtXyngP1CBWr9SoOY/EF100UUX7T9wHMdxHMfxP1gK1PqVAvU/QPjggw8++D8g5u0MiXn7PwjU+pUCtf4/+OCDDz74AEDsVwrU+pUCQNzOkJi3MwRA0EUXXXTRBUDEvJ0hMW8HQLgzJObtDAlArKqqqqqqCkCcITFvZ0gMQJCYtzMk5g1AhA8++OCDD0A8Q2LezpAQQLR+pUCtXxFALrrooosuEkCo9SsFav0SQCIxb2dIzBNAmmyyySabFEAUqPUrBWoVQI7jOI7jOBZACB988MEHF0CAWr9SoNYXQPyVArV+pRhAdNFFF110GUDsDIl5O0MaQGhIzNsZEhtA4IMPPvjgG0Bcv1Kg1q8cQNT6lQK1fh1ATDbZZJNNHkDIcRzHcRwfQECtXylQ6x9AXHTRRRddIEAaEvN2hsQgQNavFKj1KyFAlE022WSTIUBQ61cK1PohQAyJeTtDYiJAyiabbLLJIkCGxLydITEjQERi3s6QmCNAAAAAAAAAJEA=","dtype":"float64","shape":[100]},"y":{"__ndarray__":"rwBjUHvaAMCRL/HvQw8BwLLVzVFPWfu/ESpqh5FW/7/HD7xMp9r8v11Y6TEhHQLA8ii92+8gA8BiOkEx088BwDIHl4nEC/+/xI2eXZEf/7//AQVVUJD+v9ivMdUVB/+/qWY/0z8SAMC3SDimy1f/vxBofhNnQgLA8cyCxdQZ+7/XQskXj/cAwK+aCXIXrADA6NtCQKAEAcD1+yyq5Zz8vx2ehz0hRP+/saieoT2n/78Y3r6bIk0AwPfcTwzQFQLAsVQUXnJ+AMBSpa0SoWQDwMl7Qs+ZvP6/ijgQ6zi9AcDCTh5jXGb7v6898kti0AHACL5EH6F5/b9ETSYV6YEAwMqC3opLJgDAUYj/5atcAMB5Gudz/6j9vyfmV0s/Qv+/We8UFVhTAcAel0JwHssCwKVnTmluyAHAZtUMsn5CAcCTuipyV4wAwMYVWI8XL/2/omZAqSyx/r87gx0qwsX6vxXKC225twDABlF2Vifu/7+nqMe+d5UBwF0zgETLZfq/e82peYVf/b+xnggo99L8v4XXlXRFovy/GHiYvTTR979OmP2WFDz9v20Y69iXiPy/pp5BBSvw9b8Yj/xP4d34v4z/0sULova/YDsH/KsB978hLzXIH3fzv5EeP5Ses/S/epvCNji68L+uaS+h0Oj0vxBpAXFLDfS/1yxtLlyD8b8Flp+nG0Hyv4aCfB1tNPi/tOnZnD158r9HAdCzFw/0v6eCFtiJZfa/9ZOwcNSM+L+2AXSinB3zv4t3Gvql6vC/+/4Q4hGm9L+aE5Lnzkr4v/Tfr5359/K/DV1H7RUA7799X7dKuN38vx2h+OgSr/O/FYT5ILwi8r8+sYtU6g32v+xMdVouZfG/A7j9G7HL879MOvw668r3v0YyAe6VrfS/PgutPY2y7r9OZ/yTRQ3sv66aZMYGB/a/Ua0x/LhF9r8iWgV7ytTzv/MPcy7C+fW//qIDhVVm8r/wjNeCkgfwvymBWihNTPS/crbiWMNJ8r97nroZupnyv1V2GIEZzfG/6sLeUr7W8b9H6NkWoHz2v/V7SSmoYfG//XmV3/jc8r8=","dtype":"float64","shape":[100]}},"selected":{"id":"1069"},"selection_policy":{"id":"1070"}},"id":"1047","type":"ColumnDataSource"},{"attributes":{},"id":"1025","type":"HelpTool"},{"attributes":{"active_drag":"auto","active_inspect":"auto","active_multi":null,"active_scroll":"auto","active_tap":"auto","tools":[{"id":"1020"},{"id":"1021"},{"id":"1022"},{"id":"1023"},{"id":"1024"},{"id":"1025"}]},"id":"1027","type":"Toolbar"},{"attributes":{"source":{"id":"1047"}},"id":"1051","type":"CDSView"},{"attributes":{"data":{"x":{"__ndarray__":"AAAAAAAAJMBDYt7OkJgjwIbEvJ0hMSPAyiabbLLJIsANiXk7Q2IiwFDrVwrU+iHAk0022WSTIcDXrxSo9SshwBoS83aGxCDAXXTRRRddIMBArV8pUOsfwMdxHMdxHB/ATjbZZJNNHsDU+pUCtX4dwFq/UqDWrxzA4YMPPvjgG8BoSMzbGRIbwO4MiXk7QxrAdNFFF110GcD7lQK1fqUYwIFav1Kg1hfACB988MEHF8CO4ziO4zgWwBWo9SsFahXAm2yyySabFMAiMW9nSMwTwKj1KwVq/RLAL7rooosuEsC1fqVArV8RwDxDYt7OkBDAhA8++OCDD8CSmLczJOYNwJ4hMW9nSAzAqqqqqqqqCsC4MyTm7QwJwMS8nSExbwfA0kUXXXTRBcDezpCYtzMEwOxXCtT6lQLA+OCDDz74AMAI1PqVArX+vyjm7QyJefu/QPjggw8++L9YCtT6lQL1v3Acx3Ecx/G/IF100UUX7b9QgVq/UqDmv4ClQK1fKeC/YJNNNtlk078Ab2dIzNu5vwBvZ0jM27k/YJNNNtlk0z+ApUCtXyngP1CBWr9SoOY/EF100UUX7T9wHMdxHMfxP1gK1PqVAvU/QPjggw8++D8g5u0MiXn7PwjU+pUCtf4/+OCDDz74AEDsVwrU+pUCQNzOkJi3MwRA0EUXXXTRBUDEvJ0hMW8HQLgzJObtDAlArKqqqqqqCkCcITFvZ0gMQJCYtzMk5g1AhA8++OCDD0A8Q2LezpAQQLR+pUCtXxFALrrooosuEkCo9SsFav0SQCIxb2dIzBNAmmyyySabFEAUqPUrBWoVQI7jOI7jOBZACB988MEHF0CAWr9SoNYXQPyVArV+pRhAdNFFF110GUDsDIl5O0MaQGhIzNsZEhtA4IMPPvjgG0Bcv1Kg1q8cQNT6lQK1fh1ATDbZZJNNHkDIcRzHcRwfQECtXylQ6x9AXHTRRRddIEAaEvN2hsQgQNavFKj1KyFAlE022WSTIUBQ61cK1PohQAyJeTtDYiJAyiabbLLJIkCGxLydITEjQERi3s6QmCNAAAAAAAAAJEA=","dtype":"float64","shape":[100]},"y":{"__ndarray__":"FPjmHTarAMBdH0cBNqsAwBFBw9s1qwDApW+YqjWrAMDvKyhqNasAwPkytBU1qwDArB0FpzSrAMCBPvUVNKsAwI4e11czqwDAJU6sXjKrAMDDux0YMasAwOUrImwvqwDA22c5Oy2rAMC21xpcKqsAwNfoq5gmqwDAoR4FqiGrAMA9+jozG6sAwEzBiLoSqwDA5edcoAerAMCRVp8T+aoAwLEkVgLmqgDAPRCKBc2qAMDIXPRGrKoAwKT0jV6BqgDAgkCEJUmqAMAn/ll7/6kAwD1JBvmeqQDAbvOsjCCpAMAhnQL3eqgAwDH8hSGipwDAc1xiQoamAMBgKgrAEqUAwGAGc8MsowDA1XiNZLGgAMBJcJVZc50AwCwyJhA4mQDANmhaGLSTAMDfbL3RhowAwNHuZlw1gwDAJq7g9SR3AMAKTiYslWcAwGbxZr6aUwDAiWSipxw6AMDbu3yt1RkAwPVh0pi74v+/3V8FTn9+/78cdjIZPAT/v1SuZV3Xcf6/Jw1BPGTG/b+ECO7guQL9v3d6iyzpKfy/iM+8SV5B+7+QyQtShVD6v9YypVnuX/m/JOsMKyB4+L+ytCyubaD3v2qK8LUg3va/eL8VlSY09r/+N64DOKP1v2/BGR5SKvW/ocqAKU3H9L86nHIvaXf0v+BkNUy7N/S/is6FqHYF9L8x7UWwFd7zv/Eeg8Vrv/O/1OxZq6en87/3hGA9TZXzv0jEaAsrh/O/1TAau05887/isPbO+XPzv4Dedp2XbfO//gC1wbRo87/ql0wH+GTzvxYhmK8cYvO/5plx4O1f87/cMF4KQ17zv0qzrRf9XPO/yoYkPARc878m9GVDRlvzv17blUK1WvO/yI0ml0Za878zGWUh8lnzv8E6HK2xWfO/KhWtfYBZ87+FQ2L1WlnzvyoCo1E+WfO/ouAidyhZ87+fzkzKF1nzv4l9CBELWfO/1JylWwFZ87+UAT3z+VjzvxJvPUz0WPO/UpEn/O9Y878oT7ix7Fjzv1Up7i7qWPO/CC95ROhY878/qz/O5ljzv1gAtrDlWPO/eKvX1uRY878=","dtype":"float64","shape":[100]}},"selected":{"id":"1058"},"selection_policy":{"id":"1059"}},"id":"1034","type":"ColumnDataSource"},{"attributes":{"fill_color":{"value":"#1f77b4"},"line_color":{"value":"#1f77b4"},"size":{"units":"screen","value":10},"x":{"field":"x"},"y":{"field":"y"}},"id":"1048","type":"Circle"},{"attributes":{},"id":"1020","type":"PanTool"},{"attributes":{"fill_alpha":{"value":0.1},"fill_color":{"value":"#1f77b4"},"line_alpha":{"value":0.1},"line_color":{"value":"#1f77b4"},"size":{"units":"screen","value":10},"x":{"field":"x"},"y":{"field":"y"}},"id":"1049","type":"Circle"},{"attributes":{},"id":"1021","type":"WheelZoomTool"},{"attributes":{},"id":"1023","type":"SaveTool"},{"attributes":{},"id":"1024","type":"ResetTool"},{"attributes":{"data_source":{"id":"1047"},"glyph":{"id":"1048"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"1049"},"selection_glyph":null,"view":{"id":"1051"}},"id":"1050","type":"GlyphRenderer"},{"attributes":{"line_alpha":0.1,"line_dash":[6],"line_width":5,"x":{"field":"x"},"y":{"field":"y"}},"id":"1036","type":"Line"},{"attributes":{},"id":"1069","type":"Selection"},{"attributes":{},"id":"1006","type":"DataRange1d"},{"attributes":{"data_source":{"id":"1034"},"glyph":{"id":"1035"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"1036"},"selection_glyph":null,"view":{"id":"1038"}},"id":"1037","type":"GlyphRenderer"},{"attributes":{},"id":"1070","type":"UnionRenderers"},{"attributes":{"align":"center","text":"Model and random data","text_font":"Titillium Web, sans-serif","text_font_size":{"value":"1.5rem"}},"id":"1002","type":"Title"},{"attributes":{"label":{"value":"model"},"renderers":[{"id":"1037"}]},"id":"1046","type":"LegendItem"},{"attributes":{"label":{"value":"random data"},"renderers":[{"id":"1050"}]},"id":"1060","type":"LegendItem"},{"attributes":{"line_dash":[6],"line_width":5,"x":{"field":"x"},"y":{"field":"y"}},"id":"1035","type":"Line"}],"root_ids":["1001"]},"title":"Bokeh Application","version":"2.0.2"}}
</script>
<script type="text/javascript">
  (function() {
    var fn = function() {
      Bokeh.safely(function() {
        (function(root) {
          function embed_document(root) {
            
          var docs_json = document.getElementById('1171').textContent;
          var render_items = [{"docid":"26c41516-766b-4dff-bf7c-9a2d4e56766a","root_ids":["1001"],"roots":{"1001":"6b178832-9bd3-4d57-87b5-f0833b3f4984"}}];
          root.Bokeh.embed.embed_items(docs_json, render_items);
        
          }
          if (root.Bokeh !== undefined) {
            embed_document(root);
          } else {
            var attempts = 0;
            var timer = setInterval(function(root) {
              if (root.Bokeh !== undefined) {
                clearInterval(timer);
                embed_document(root);
              } else {
                attempts++;
                if (attempts > 100) {
                  clearInterval(timer);
                  console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
                }
              }
            }, 10, root)
          }
        })(window);
      });
    };
    if (document.readyState != "loading") fn();
    else document.addEventListener("DOMContentLoaded", fn);
  })();
</script>
        </div>
      
    </section>
    <section class="text-section">
      <div>
        <p>We now assume that we only have access to the data points and not the underlying generative function. 
These points could have been obtained during an experiment. </p>

<p>By looking at the data, the points appear to approximately follow a sigmoid, so we may want to try to fit such a 
curve to the points. 
That&#39;s what curve fitting is about. </p>

<p>SciPy&#39;s <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html" target="_blank"><code>curve_fit()</code></a> 
function allows us to fit a curve defined by an 
arbitrary Python function to the data:</p>

        </div>
      
    </section>
    <section class="code-section">
      <div>
        <pre class="code-block"><span class="highlight"><span class="p">(</span><span class="n">a_</span><span class="p">,</span> <span class="n">b_</span><span class="p">,</span> <span class="n">c_</span><span class="p">,</span> <span class="n">d_</span><span class="p">),</span> <span class="n">_</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">curve_fit</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span></span></pre></div>
      
    </section>
    <section class="text-section">
      <div>
        <p>And use those parameters to estimate our underlying curve</p>

        </div>
      
    </section>
    <section class="code-section">
      <div>
        <pre class="code-block"><span class="highlight"><span class="n">y_fit</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a_</span><span class="p">,</span> <span class="n">b_</span><span class="p">,</span> <span class="n">c_</span><span class="p">,</span> <span class="n">d_</span><span class="p">)</span></span></pre></div>
      
    </section>
    <section class="plot-section">
      <div>
        
            <div class="bk-root" id="b0bd9b52-fd55-402d-a382-d4d8f107ac66" data-root-id="1172"></div>
<script type="application/json" id="1380">
  {"61a94426-b8ba-4f1e-a12e-69ab3633952a":{"roots":{"references":[{"attributes":{},"id":"1191","type":"PanTool"},{"attributes":{"fill_alpha":{"value":0.1},"fill_color":{"value":"#1f77b4"},"line_alpha":{"value":0.1},"line_color":{"value":"#1f77b4"},"size":{"units":"screen","value":10},"x":{"field":"x"},"y":{"field":"y"}},"id":"1220","type":"Circle"},{"attributes":{"data_source":{"id":"1218"},"glyph":{"id":"1219"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"1220"},"selection_glyph":null,"view":{"id":"1222"}},"id":"1221","type":"GlyphRenderer"},{"attributes":{"data_source":{"id":"1232"},"glyph":{"id":"1233"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"1234"},"selection_glyph":null,"view":{"id":"1236"}},"id":"1235","type":"GlyphRenderer"},{"attributes":{"label":{"value":"random data"},"renderers":[{"id":"1221"}]},"id":"1231","type":"LegendItem"},{"attributes":{},"id":"1181","type":"LinearScale"},{"attributes":{"fill_color":{"value":"#1f77b4"},"line_color":{"value":"#1f77b4"},"size":{"units":"screen","value":10},"x":{"field":"x"},"y":{"field":"y"}},"id":"1219","type":"Circle"},{"attributes":{"source":{"id":"1218"}},"id":"1222","type":"CDSView"},{"attributes":{"data":{"x":{"__ndarray__":"AAAAAAAAJMBDYt7OkJgjwIbEvJ0hMSPAyiabbLLJIsANiXk7Q2IiwFDrVwrU+iHAk0022WSTIcDXrxSo9SshwBoS83aGxCDAXXTRRRddIMBArV8pUOsfwMdxHMdxHB/ATjbZZJNNHsDU+pUCtX4dwFq/UqDWrxzA4YMPPvjgG8BoSMzbGRIbwO4MiXk7QxrAdNFFF110GcD7lQK1fqUYwIFav1Kg1hfACB988MEHF8CO4ziO4zgWwBWo9SsFahXAm2yyySabFMAiMW9nSMwTwKj1KwVq/RLAL7rooosuEsC1fqVArV8RwDxDYt7OkBDAhA8++OCDD8CSmLczJOYNwJ4hMW9nSAzAqqqqqqqqCsC4MyTm7QwJwMS8nSExbwfA0kUXXXTRBcDezpCYtzMEwOxXCtT6lQLA+OCDDz74AMAI1PqVArX+vyjm7QyJefu/QPjggw8++L9YCtT6lQL1v3Acx3Ecx/G/IF100UUX7b9QgVq/UqDmv4ClQK1fKeC/YJNNNtlk078Ab2dIzNu5vwBvZ0jM27k/YJNNNtlk0z+ApUCtXyngP1CBWr9SoOY/EF100UUX7T9wHMdxHMfxP1gK1PqVAvU/QPjggw8++D8g5u0MiXn7PwjU+pUCtf4/+OCDDz74AEDsVwrU+pUCQNzOkJi3MwRA0EUXXXTRBUDEvJ0hMW8HQLgzJObtDAlArKqqqqqqCkCcITFvZ0gMQJCYtzMk5g1AhA8++OCDD0A8Q2LezpAQQLR+pUCtXxFALrrooosuEkCo9SsFav0SQCIxb2dIzBNAmmyyySabFEAUqPUrBWoVQI7jOI7jOBZACB988MEHF0CAWr9SoNYXQPyVArV+pRhAdNFFF110GUDsDIl5O0MaQGhIzNsZEhtA4IMPPvjgG0Bcv1Kg1q8cQNT6lQK1fh1ATDbZZJNNHkDIcRzHcRwfQECtXylQ6x9AXHTRRRddIEAaEvN2hsQgQNavFKj1KyFAlE022WSTIUBQ61cK1PohQAyJeTtDYiJAyiabbLLJIkCGxLydITEjQERi3s6QmCNAAAAAAAAAJEA=","dtype":"float64","shape":[100]},"y":{"__ndarray__":"eQhK7KpOAMB/eVfpqk4AwM7BTOWqTgDAUNzB36pOAMDfJCjYqk4AwFIBvM2qTgDAkTdxv6pOAMCn9terqk4AwOXc95CqTgDAdkMdbKpOAMCutpM5qk4AwLGdRvSpTgDACnw+lalOAMDqqO0SqU4AwBN3OmCoTgDASxgua6dOAMAPXCYbpk4AwKDXW06kTgDAVct81qFOAMBWfQV0nk4AwGFp3s+ZTgDACliccpNOAMBYyYG4ik4AwOIjDsF+TgDA+6l1WG5OAMAJVMLYV04AwOCKiv84TgDA9Y0LtA5OAMCZ6u+31E0AwDe0/DqFTQDAE8ceRxhNAMBrDaf2gkwAwK8otGG2SwDAHmiSKZ5KAMCOPRKBHkkAwC2rgYcRRwDAPrmiwUNEAMCNTEtyb0AAwFJzFY82OwDAy61QFBs0AMD6XIWcdSoAwIiw+3NqHQDA/5SQDt4LAMAw65wE1uj/v7+islC7qv+/Hbham3hZ/7+23aW3y/D+v8ZFaYikbP6/5DXKSPjJ/b+AgBb/2gf9v1oOkyehKPy/pUQSGZUy+7932aTavC/6vzsSDodzLPm/8nV5nCk1+L+yFkklHVT3v/hAm6Lfj/a/0o6cvQfr9b9fmrcY2mT1v/M4F8Rn+vS/reKq6qqn9L/+6dLKX2j0v9H6OPGKOPS/GNVCe7oU9L+Qh2XfGPrzvxJA02Zl5vO/5GcGmODX87828Z0rNc3zv7QWeglixfO/lubWO6e/878wJ25adrvzv7zz3z1muPO/Hrw1hCm2878eQTpfh7Tzv+Rn3S5Ws/O/mSbpfHey87+esv4D1bHzvxYEq35esfO/bCcsCwix87/qHyH9yLDzv0qeLACbsPO/kvULdnmw879yBEMAYbDzv6b6rilPsPO/sBltJ0Kw878cMM2qOLDzv5Xttr8xsPO/b6kltCyw87+AA0YGKbDzv5ZcalcmsPO/FhiHYiSw878LJEL1IrDzv15h4+ohsPO/4sajKCGw879ZUPyaILDzv/B6rzMgsPO/wc5a6B+w878boGuxH7DzvwYsXIkfsPO/+HglbB+w878=","dtype":"float64","shape":[100]}},"selected":{"id":"1258"},"selection_policy":{"id":"1259"}},"id":"1232","type":"ColumnDataSource"},{"attributes":{},"id":"1184","type":"BasicTicker"},{"attributes":{"data":{"x":{"__ndarray__":"AAAAAAAAJMBDYt7OkJgjwIbEvJ0hMSPAyiabbLLJIsANiXk7Q2IiwFDrVwrU+iHAk0022WSTIcDXrxSo9SshwBoS83aGxCDAXXTRRRddIMBArV8pUOsfwMdxHMdxHB/ATjbZZJNNHsDU+pUCtX4dwFq/UqDWrxzA4YMPPvjgG8BoSMzbGRIbwO4MiXk7QxrAdNFFF110GcD7lQK1fqUYwIFav1Kg1hfACB988MEHF8CO4ziO4zgWwBWo9SsFahXAm2yyySabFMAiMW9nSMwTwKj1KwVq/RLAL7rooosuEsC1fqVArV8RwDxDYt7OkBDAhA8++OCDD8CSmLczJOYNwJ4hMW9nSAzAqqqqqqqqCsC4MyTm7QwJwMS8nSExbwfA0kUXXXTRBcDezpCYtzMEwOxXCtT6lQLA+OCDDz74AMAI1PqVArX+vyjm7QyJefu/QPjggw8++L9YCtT6lQL1v3Acx3Ecx/G/IF100UUX7b9QgVq/UqDmv4ClQK1fKeC/YJNNNtlk078Ab2dIzNu5vwBvZ0jM27k/YJNNNtlk0z+ApUCtXyngP1CBWr9SoOY/EF100UUX7T9wHMdxHMfxP1gK1PqVAvU/QPjggw8++D8g5u0MiXn7PwjU+pUCtf4/+OCDDz74AEDsVwrU+pUCQNzOkJi3MwRA0EUXXXTRBUDEvJ0hMW8HQLgzJObtDAlArKqqqqqqCkCcITFvZ0gMQJCYtzMk5g1AhA8++OCDD0A8Q2LezpAQQLR+pUCtXxFALrrooosuEkCo9SsFav0SQCIxb2dIzBNAmmyyySabFEAUqPUrBWoVQI7jOI7jOBZACB988MEHF0CAWr9SoNYXQPyVArV+pRhAdNFFF110GUDsDIl5O0MaQGhIzNsZEhtA4IMPPvjgG0Bcv1Kg1q8cQNT6lQK1fh1ATDbZZJNNHkDIcRzHcRwfQECtXylQ6x9AXHTRRRddIEAaEvN2hsQgQNavFKj1KyFAlE022WSTIUBQ61cK1PohQAyJeTtDYiJAyiabbLLJIkCGxLydITEjQERi3s6QmCNAAAAAAAAAJEA=","dtype":"float64","shape":[100]},"y":{"__ndarray__":"rwBjUHvaAMCRL/HvQw8BwLLVzVFPWfu/ESpqh5FW/7/HD7xMp9r8v11Y6TEhHQLA8ii92+8gA8BiOkEx088BwDIHl4nEC/+/xI2eXZEf/7//AQVVUJD+v9ivMdUVB/+/qWY/0z8SAMC3SDimy1f/vxBofhNnQgLA8cyCxdQZ+7/XQskXj/cAwK+aCXIXrADA6NtCQKAEAcD1+yyq5Zz8vx2ehz0hRP+/saieoT2n/78Y3r6bIk0AwPfcTwzQFQLAsVQUXnJ+AMBSpa0SoWQDwMl7Qs+ZvP6/ijgQ6zi9AcDCTh5jXGb7v6898kti0AHACL5EH6F5/b9ETSYV6YEAwMqC3opLJgDAUYj/5atcAMB5Gudz/6j9vyfmV0s/Qv+/We8UFVhTAcAel0JwHssCwKVnTmluyAHAZtUMsn5CAcCTuipyV4wAwMYVWI8XL/2/omZAqSyx/r87gx0qwsX6vxXKC225twDABlF2Vifu/7+nqMe+d5UBwF0zgETLZfq/e82peYVf/b+xnggo99L8v4XXlXRFovy/GHiYvTTR979OmP2WFDz9v20Y69iXiPy/pp5BBSvw9b8Yj/xP4d34v4z/0sULova/YDsH/KsB978hLzXIH3fzv5EeP5Ses/S/epvCNji68L+uaS+h0Oj0vxBpAXFLDfS/1yxtLlyD8b8Flp+nG0Hyv4aCfB1tNPi/tOnZnD158r9HAdCzFw/0v6eCFtiJZfa/9ZOwcNSM+L+2AXSinB3zv4t3Gvql6vC/+/4Q4hGm9L+aE5Lnzkr4v/Tfr5359/K/DV1H7RUA7799X7dKuN38vx2h+OgSr/O/FYT5ILwi8r8+sYtU6g32v+xMdVouZfG/A7j9G7HL879MOvw668r3v0YyAe6VrfS/PgutPY2y7r9OZ/yTRQ3sv66aZMYGB/a/Ua0x/LhF9r8iWgV7ytTzv/MPcy7C+fW//qIDhVVm8r/wjNeCkgfwvymBWihNTPS/crbiWMNJ8r97nroZupnyv1V2GIEZzfG/6sLeUr7W8b9H6NkWoHz2v/V7SSmoYfG//XmV3/jc8r8=","dtype":"float64","shape":[100]}},"selected":{"id":"1245"},"selection_policy":{"id":"1246"}},"id":"1218","type":"ColumnDataSource"},{"attributes":{},"id":"1229","type":"Selection"},{"attributes":{},"id":"1230","type":"UnionRenderers"},{"attributes":{"axis":{"id":"1187"},"dimension":1,"ticker":null},"id":"1190","type":"Grid"},{"attributes":{"align":"center","text":"Model, random data and curve fit","text_font":"Titillium Web, sans-serif","text_font_size":{"value":"1.5rem"}},"id":"1173","type":"Title"},{"attributes":{"source":{"id":"1205"}},"id":"1209","type":"CDSView"},{"attributes":{"aspect_ratio":1.78,"below":[{"id":"1183"}],"center":[{"id":"1186"},{"id":"1190"},{"id":"1216"}],"left":[{"id":"1187"}],"renderers":[{"id":"1208"},{"id":"1221"},{"id":"1235"}],"sizing_mode":"stretch_both","title":{"id":"1173"},"toolbar":{"id":"1198"},"x_range":{"id":"1175"},"x_scale":{"id":"1179"},"y_range":{"id":"1177"},"y_scale":{"id":"1181"}},"id":"1172","subtype":"Figure","type":"Plot"},{"attributes":{"bottom_units":"screen","fill_alpha":0.5,"fill_color":"lightgrey","left_units":"screen","level":"overlay","line_alpha":1.0,"line_color":"black","line_dash":[4,4],"line_width":2,"render_mode":"css","right_units":"screen","top_units":"screen"},"id":"1197","type":"BoxAnnotation"},{"attributes":{},"id":"1177","type":"DataRange1d"},{"attributes":{"source":{"id":"1232"}},"id":"1236","type":"CDSView"},{"attributes":{"axis_label_text_font":"Ubuntu Mono, monospace","axis_label_text_font_size":"1.2rem","formatter":{"id":"1211"},"major_label_text_font_size":"1rem","ticker":{"id":"1184"}},"id":"1183","type":"LinearAxis"},{"attributes":{},"id":"1175","type":"DataRange1d"},{"attributes":{"line_dash":[6],"line_width":5,"x":{"field":"x"},"y":{"field":"y"}},"id":"1206","type":"Line"},{"attributes":{"line_color":"red","line_width":5,"x":{"field":"x"},"y":{"field":"y"}},"id":"1233","type":"Line"},{"attributes":{"axis":{"id":"1183"},"ticker":null},"id":"1186","type":"Grid"},{"attributes":{},"id":"1179","type":"LinearScale"},{"attributes":{"overlay":{"id":"1197"}},"id":"1193","type":"BoxZoomTool"},{"attributes":{},"id":"1211","type":"BasicTickFormatter"},{"attributes":{"line_alpha":0.1,"line_color":"red","line_width":5,"x":{"field":"x"},"y":{"field":"y"}},"id":"1234","type":"Line"},{"attributes":{},"id":"1258","type":"Selection"},{"attributes":{"label":{"value":"curve fit"},"renderers":[{"id":"1235"}]},"id":"1247","type":"LegendItem"},{"attributes":{"axis_label_text_font":"Ubuntu Mono, monospace","axis_label_text_font_size":"1.2rem","formatter":{"id":"1213"},"major_label_text_font_size":"1rem","ticker":{"id":"1188"}},"id":"1187","type":"LinearAxis"},{"attributes":{},"id":"1259","type":"UnionRenderers"},{"attributes":{},"id":"1213","type":"BasicTickFormatter"},{"attributes":{},"id":"1188","type":"BasicTicker"},{"attributes":{"data":{"x":{"__ndarray__":"AAAAAAAAJMBDYt7OkJgjwIbEvJ0hMSPAyiabbLLJIsANiXk7Q2IiwFDrVwrU+iHAk0022WSTIcDXrxSo9SshwBoS83aGxCDAXXTRRRddIMBArV8pUOsfwMdxHMdxHB/ATjbZZJNNHsDU+pUCtX4dwFq/UqDWrxzA4YMPPvjgG8BoSMzbGRIbwO4MiXk7QxrAdNFFF110GcD7lQK1fqUYwIFav1Kg1hfACB988MEHF8CO4ziO4zgWwBWo9SsFahXAm2yyySabFMAiMW9nSMwTwKj1KwVq/RLAL7rooosuEsC1fqVArV8RwDxDYt7OkBDAhA8++OCDD8CSmLczJOYNwJ4hMW9nSAzAqqqqqqqqCsC4MyTm7QwJwMS8nSExbwfA0kUXXXTRBcDezpCYtzMEwOxXCtT6lQLA+OCDDz74AMAI1PqVArX+vyjm7QyJefu/QPjggw8++L9YCtT6lQL1v3Acx3Ecx/G/IF100UUX7b9QgVq/UqDmv4ClQK1fKeC/YJNNNtlk078Ab2dIzNu5vwBvZ0jM27k/YJNNNtlk0z+ApUCtXyngP1CBWr9SoOY/EF100UUX7T9wHMdxHMfxP1gK1PqVAvU/QPjggw8++D8g5u0MiXn7PwjU+pUCtf4/+OCDDz74AEDsVwrU+pUCQNzOkJi3MwRA0EUXXXTRBUDEvJ0hMW8HQLgzJObtDAlArKqqqqqqCkCcITFvZ0gMQJCYtzMk5g1AhA8++OCDD0A8Q2LezpAQQLR+pUCtXxFALrrooosuEkCo9SsFav0SQCIxb2dIzBNAmmyyySabFEAUqPUrBWoVQI7jOI7jOBZACB988MEHF0CAWr9SoNYXQPyVArV+pRhAdNFFF110GUDsDIl5O0MaQGhIzNsZEhtA4IMPPvjgG0Bcv1Kg1q8cQNT6lQK1fh1ATDbZZJNNHkDIcRzHcRwfQECtXylQ6x9AXHTRRRddIEAaEvN2hsQgQNavFKj1KyFAlE022WSTIUBQ61cK1PohQAyJeTtDYiJAyiabbLLJIkCGxLydITEjQERi3s6QmCNAAAAAAAAAJEA=","dtype":"float64","shape":[100]},"y":{"__ndarray__":"FPjmHTarAMBdH0cBNqsAwBFBw9s1qwDApW+YqjWrAMDvKyhqNasAwPkytBU1qwDArB0FpzSrAMCBPvUVNKsAwI4e11czqwDAJU6sXjKrAMDDux0YMasAwOUrImwvqwDA22c5Oy2rAMC21xpcKqsAwNfoq5gmqwDAoR4FqiGrAMA9+jozG6sAwEzBiLoSqwDA5edcoAerAMCRVp8T+aoAwLEkVgLmqgDAPRCKBc2qAMDIXPRGrKoAwKT0jV6BqgDAgkCEJUmqAMAn/ll7/6kAwD1JBvmeqQDAbvOsjCCpAMAhnQL3eqgAwDH8hSGipwDAc1xiQoamAMBgKgrAEqUAwGAGc8MsowDA1XiNZLGgAMBJcJVZc50AwCwyJhA4mQDANmhaGLSTAMDfbL3RhowAwNHuZlw1gwDAJq7g9SR3AMAKTiYslWcAwGbxZr6aUwDAiWSipxw6AMDbu3yt1RkAwPVh0pi74v+/3V8FTn9+/78cdjIZPAT/v1SuZV3Xcf6/Jw1BPGTG/b+ECO7guQL9v3d6iyzpKfy/iM+8SV5B+7+QyQtShVD6v9YypVnuX/m/JOsMKyB4+L+ytCyubaD3v2qK8LUg3va/eL8VlSY09r/+N64DOKP1v2/BGR5SKvW/ocqAKU3H9L86nHIvaXf0v+BkNUy7N/S/is6FqHYF9L8x7UWwFd7zv/Eeg8Vrv/O/1OxZq6en87/3hGA9TZXzv0jEaAsrh/O/1TAau05887/isPbO+XPzv4Dedp2XbfO//gC1wbRo87/ql0wH+GTzvxYhmK8cYvO/5plx4O1f87/cMF4KQ17zv0qzrRf9XPO/yoYkPARc878m9GVDRlvzv17blUK1WvO/yI0ml0Za878zGWUh8lnzv8E6HK2xWfO/KhWtfYBZ87+FQ2L1WlnzvyoCo1E+WfO/ouAidyhZ87+fzkzKF1nzv4l9CBELWfO/1JylWwFZ87+UAT3z+VjzvxJvPUz0WPO/UpEn/O9Y878oT7ix7Fjzv1Up7i7qWPO/CC95ROhY878/qz/O5ljzv1gAtrDlWPO/eKvX1uRY878=","dtype":"float64","shape":[100]}},"selected":{"id":"1229"},"selection_policy":{"id":"1230"}},"id":"1205","type":"ColumnDataSource"},{"attributes":{"active_drag":"auto","active_inspect":"auto","active_multi":null,"active_scroll":"auto","active_tap":"auto","tools":[{"id":"1191"},{"id":"1192"},{"id":"1193"},{"id":"1194"},{"id":"1195"},{"id":"1196"}]},"id":"1198","type":"Toolbar"},{"attributes":{},"id":"1194","type":"SaveTool"},{"attributes":{},"id":"1195","type":"ResetTool"},{"attributes":{"data_source":{"id":"1205"},"glyph":{"id":"1206"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"1207"},"selection_glyph":null,"view":{"id":"1209"}},"id":"1208","type":"GlyphRenderer"},{"attributes":{},"id":"1245","type":"Selection"},{"attributes":{},"id":"1246","type":"UnionRenderers"},{"attributes":{},"id":"1196","type":"HelpTool"},{"attributes":{"label":{"value":"model"},"renderers":[{"id":"1208"}]},"id":"1217","type":"LegendItem"},{"attributes":{"line_alpha":0.1,"line_dash":[6],"line_width":5,"x":{"field":"x"},"y":{"field":"y"}},"id":"1207","type":"Line"},{"attributes":{},"id":"1192","type":"WheelZoomTool"},{"attributes":{"click_policy":"hide","items":[{"id":"1217"},{"id":"1231"},{"id":"1247"}],"label_text_font":"Merriweather, serif","label_text_font_size":"1rem","location":"top_left"},"id":"1216","type":"Legend"}],"root_ids":["1172"]},"title":"Bokeh Application","version":"2.0.2"}}
</script>
<script type="text/javascript">
  (function() {
    var fn = function() {
      Bokeh.safely(function() {
        (function(root) {
          function embed_document(root) {
            
          var docs_json = document.getElementById('1380').textContent;
          var render_items = [{"docid":"61a94426-b8ba-4f1e-a12e-69ab3633952a","root_ids":["1172"],"roots":{"1172":"b0bd9b52-fd55-402d-a382-d4d8f107ac66"}}];
          root.Bokeh.embed.embed_items(docs_json, render_items);
        
          }
          if (root.Bokeh !== undefined) {
            embed_document(root);
          } else {
            var attempts = 0;
            var timer = setInterval(function(root) {
              if (root.Bokeh !== undefined) {
                clearInterval(timer);
                embed_document(root);
              } else {
                attempts++;
                if (attempts > 100) {
                  clearInterval(timer);
                  console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
                }
              }
            }, 10, root)
          }
        })(window);
      });
    };
    if (document.readyState != "loading") fn();
    else document.addEventListener("DOMContentLoaded", fn);
  })();
</script>
        </div>
      
    </section>
    <section class="text-section">
      <div>
        <p>we can also manually compare our initial parameters with with those from <code>curve_fit()</code>:</p>

        </div>
      
    </section>
    <section class="print-section">
      <div>
        <pre class="print-statement">initial parameters:    a=0.8744 b=-2.0836 c=1.3389 d=0.4991 </pre><pre class="print-statement">curve_fit parameters:  a=0.8079 b=-2.0384 c=1.5630 d=0.5120 </pre>
        </div>
      
    </section>

      </main>
    </article>
  </body>
  
  <script>
    MathJax = {startup: {elements: ['p.equation']}, svg: {scale: 1.2}}
    show_eq = () => document.querySelectorAll('p.equation').forEach(e => e.classList.remove('d-none'))
  </script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-svg.js" crossorigin="anonymous" onload="show_eq()">
  </script>
    <script src="https://cdn.bokeh.org/bokeh/release/bokeh-2.0.2.min.js"
          integrity="sha384-ufR9RFnRs6lniiaFvtJziE0YeidtAgBRH6ux2oUItHw5WTvE1zuk9uzhUU/FJXDp"
          crossorigin="anonymous"></script>
  

  
</html>